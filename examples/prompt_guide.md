# 進階應用：指令工程指南 (Prompt Engineering Guide)

## 💡 為什麼 Prompt 很重要？
AI Agent 雖然強大，但它本質上是一個「預測下一個字」的機率模型。你的 Prompt (指令) 是唯一的導航系統，決定了 Agent 如何分配它的「注意力」與「運算資源」。

- **模糊指令** ➡️ Agent 只能猜測你的意圖 ➡️ 輸出平庸或錯誤的結果。
- **精確指令** ➡️ Agent 理解脈絡與限制 ➡️ 輸出精準且即用的結果。

---

## 🏗️ Prompt 撰寫四大要素 (The 4 Pillars)

一個完美的 Prompt 通常包含以下四個要素：

### 1. 角色 (Persona / Role)
告訴 Agent 它「是誰」。這會啟動特定的知識領域與語氣。
> ❌ "幫我寫一個 Python 腳本。"
> ✅ "你是一位**資深 DevOps 工程師**，專精於自動化部署與 CI/CD pipeline..."

### 2. 脈絡 (Context)
提供背景資訊，讓 Agent 知道「為什麼」要做這件事。
> ❌ "寫一個爬蟲抓股價。"
> ✅ "我正在開發一個**個人理財儀表板**，需要一個每日執行的爬蟲，從 Yahoo Finance 抓取台積電的收盤價，並存入 SQLite 資料庫..."

### 3. 明確任務 (Task)
具體說明「要做什麼」，使用強動詞。
> ❌ "做一下除錯。"
> ✅ "請**分析** `src/api.py` 中的 `fetch_data` 函數，**找出**導致 `TimeoutError` 的原因，並**實作**重試機制 (Retry Mechanism) 來修復它。"

### 4. 限制與格式 (Constraints & Format)
規範輸出的形式，避免 Agent 廢話過多或格式不對。
> ❌ "解釋一下。"
> ✅ "請用 **Markdown 表格**比較 A 與 B 的優缺點。輸出**不要超過 200 字**。**只列出**最重要的 3 點。"

---

## 🔄 優化流程 (Iterative Refinement)

很少有人能一次寫出完美的 Prompt。請遵循「迭代優化」的流程：

1.  **V1 (直覺版)**：先寫下你想要什麼。
    > "幫我看這段程式碼有什麼問題。"
2.  **V2 (補充脈絡)**：發現 Agent 回答太籠統，於是補充細節。
    > "這段程式碼是用來處理使用者上傳圖片的，但在大檔案時會崩潰。幫我看有什麼效能問題。"
3.  **V3 (加上限制)**：Agent 給了一堆解釋但沒給 Code，於是加上格式要求。
    > "請**條列出** 3 個可能的效能瓶頸，並直接提供**優化後的 Python 程式碼**，加上註解說明改動原因。"

---

## 🛠️ 實用技巧

### Chain of Thought (思路引導)
強迫 Agent 先思考再回答，可以大幅提升邏輯正確率。
> "在給出最終答案之前，請先**一步一步地思考 (Think step-by-step)**，並列出你的推論過程。"

### Few-Shot Prompting (提供範例)
給 Agent 看一兩個「範例」，讓它模仿。
> "請將以下資料轉換為 JSON 格式。
> 範例：
> 輸入：Jim, 30歲, 工程師
> 輸出：{\"name\": \"Jim\", \"age\": 30, \"job\": \"Engineer\"}
>
> 輸入：Alice, 25歲, 設計師
> 輸出：..."

---

## 🎯 結論
Prompt Engineering 不是魔法，而是一種**精確溝通的藝術**。當你覺得 Agent 變笨了，通常是因為你的指令不夠清楚。多花 1 分鐘思考 Prompt，可以省下 10 分鐘除錯的時間。
